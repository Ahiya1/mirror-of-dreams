<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="manifest" href="/site.webmanifest" />
    <title>Gift Sacred Consciousness | Mirror of Truth</title>
    <link rel="stylesheet" href="/shared/foundation.css" />

    <style>
      /* Sacred Gift Experience - Reimagined Beauty */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      html,
      body {
        height: 100vh;
        overflow: hidden;
        background: radial-gradient(
          circle at 30% 70%,
          #0a0a1f 0%,
          #0f0f23 25%,
          #1a1a2e 50%,
          #16213e 75%,
          #0a0a1f 100%
        );
        color: #fff;
        font-family: Inter, -apple-system, BlinkMacSystemFont, sans-serif;
        position: fixed;
        width: 100vw;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        touch-action: manipulation;
      }

      /* Cosmic Consciousness Background */
      .cosmic-canvas {
        position: fixed;
        inset: 0;
        pointer-events: none;
        z-index: 1;
        overflow: hidden;
      }

      .consciousness-layer {
        position: absolute;
        inset: 0;
        opacity: 0.6;
        animation: consciousnessFlow 60s ease-in-out infinite;
      }

      .consciousness-layer:nth-child(1) {
        background: radial-gradient(
            ellipse at 20% 80%,
            rgba(147, 51, 234, 0.08) 0%,
            rgba(99, 102, 241, 0.04) 30%,
            transparent 60%
          ),
          radial-gradient(
            ellipse at 80% 20%,
            rgba(16, 185, 129, 0.06) 0%,
            rgba(59, 130, 246, 0.03) 40%,
            transparent 70%
          );
        animation-delay: 0s;
      }

      .consciousness-layer:nth-child(2) {
        background: conic-gradient(
          from 45deg at 50% 50%,
          rgba(251, 191, 36, 0.04) 0deg,
          rgba(236, 72, 153, 0.03) 90deg,
          rgba(168, 85, 247, 0.04) 180deg,
          rgba(6, 182, 212, 0.03) 270deg,
          rgba(251, 191, 36, 0.04) 360deg
        );
        animation-delay: 20s;
        animation-duration: 80s;
      }

      .consciousness-layer:nth-child(3) {
        background: linear-gradient(
          135deg,
          rgba(99, 102, 241, 0.02) 0%,
          transparent 25%,
          rgba(236, 72, 153, 0.03) 50%,
          transparent 75%,
          rgba(16, 185, 129, 0.02) 100%
        );
        animation-delay: 40s;
        animation-duration: 100s;
      }

      @keyframes consciousnessFlow {
        0%,
        100% {
          transform: rotate(0deg) scale(1) translate(0, 0);
          opacity: 0.6;
        }
        25% {
          transform: rotate(90deg) scale(1.1) translate(20px, -20px);
          opacity: 0.8;
        }
        50% {
          transform: rotate(180deg) scale(0.9) translate(-20px, 20px);
          opacity: 0.4;
        }
        75% {
          transform: rotate(270deg) scale(1.05) translate(10px, -10px);
          opacity: 0.7;
        }
      }

      /* Sacred Particles System */
      .sacred-particles {
        position: fixed;
        inset: 0;
        pointer-events: none;
        z-index: 2;
      }

      .sacred-particle {
        position: absolute;
        border-radius: 50%;
        animation: sacredAscension 45s linear infinite;
      }

      .particle-consciousness {
        width: 2px;
        height: 2px;
        background: radial-gradient(
          circle,
          rgba(251, 191, 36, 0.8) 0%,
          rgba(251, 191, 36, 0.3) 40%,
          transparent 80%
        );
        box-shadow: 0 0 8px rgba(251, 191, 36, 0.4);
      }

      .particle-wisdom {
        width: 1.5px;
        height: 1.5px;
        background: radial-gradient(
          circle,
          rgba(147, 51, 234, 0.9) 0%,
          rgba(147, 51, 234, 0.2) 50%,
          transparent 80%
        );
        box-shadow: 0 0 6px rgba(147, 51, 234, 0.3);
      }

      .particle-love {
        width: 1px;
        height: 1px;
        background: radial-gradient(
          circle,
          rgba(236, 72, 153, 0.7) 0%,
          rgba(236, 72, 153, 0.2) 60%,
          transparent 80%
        );
        box-shadow: 0 0 4px rgba(236, 72, 153, 0.2);
      }

      .sacred-particle:nth-child(1) {
        left: 15%;
        animation-delay: 0s;
        animation-duration: 50s;
      }
      .sacred-particle:nth-child(2) {
        left: 35%;
        animation-delay: 8s;
        animation-duration: 47s;
      }
      .sacred-particle:nth-child(3) {
        left: 55%;
        animation-delay: 16s;
        animation-duration: 52s;
      }
      .sacred-particle:nth-child(4) {
        left: 75%;
        animation-delay: 24s;
        animation-duration: 48s;
      }
      .sacred-particle:nth-child(5) {
        left: 25%;
        animation-delay: 32s;
        animation-duration: 55s;
      }
      .sacred-particle:nth-child(6) {
        left: 65%;
        animation-delay: 40s;
        animation-duration: 49s;
      }

      @keyframes sacredAscension {
        0% {
          transform: translateY(105vh) rotate(0deg) scale(0.5);
          opacity: 0;
        }
        10% {
          opacity: 0.8;
          transform: translateY(95vh) rotate(36deg) scale(0.7);
        }
        50% {
          opacity: 1;
          transform: translateY(50vh) rotate(180deg) scale(1);
        }
        90% {
          opacity: 0.3;
          transform: translateY(5vh) rotate(324deg) scale(1.2);
        }
        100% {
          transform: translateY(-10vh) rotate(360deg) scale(0.8);
          opacity: 0;
        }
      }

      /* Ethereal Navigation */
      .return-portal {
        position: fixed;
        top: clamp(1.5rem, 4vh, 2.5rem);
        left: clamp(1.5rem, 4vw, 2.5rem);
        z-index: 100;
        display: flex;
        align-items: center;
        gap: 0.8rem;
        background: linear-gradient(
          135deg,
          rgba(255, 255, 255, 0.12) 0%,
          rgba(255, 255, 255, 0.04) 100%
        );
        backdrop-filter: blur(25px) saturate(150%);
        border: 1px solid rgba(255, 255, 255, 0.2);
        color: rgba(255, 255, 255, 0.9);
        padding: clamp(0.8rem, 2vh, 1rem) clamp(1.2rem, 3vw, 1.5rem);
        border-radius: 50px;
        cursor: pointer;
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        font-weight: 400;
        font-size: clamp(0.85rem, 2.2vw, 0.95rem);
        text-decoration: none;
        touch-action: manipulation;
        -webkit-tap-highlight-color: transparent;
        min-height: 48px;
        white-space: nowrap;
        box-shadow: 0 8px 32px rgba(255, 255, 255, 0.1);
      }

      .return-portal::before {
        content: "";
        position: absolute;
        inset: -1px;
        background: linear-gradient(
          135deg,
          rgba(255, 255, 255, 0.2) 0%,
          rgba(255, 255, 255, 0.05) 100%
        );
        border-radius: 50px;
        opacity: 0;
        transition: opacity 0.4s ease;
        z-index: -1;
      }

      .return-portal:hover {
        background: linear-gradient(
          135deg,
          rgba(255, 255, 255, 0.18) 0%,
          rgba(255, 255, 255, 0.08) 100%
        );
        border-color: rgba(255, 255, 255, 0.3);
        color: rgba(255, 255, 255, 0.95);
        transform: translateY(-2px) scale(1.02);
        box-shadow: 0 12px 40px rgba(255, 255, 255, 0.15);
      }

      .return-portal:hover::before {
        opacity: 1;
      }

      .return-portal:active {
        transform: translateY(0) scale(0.98);
        transition: transform 0.1s ease;
      }

      /* Sacred Gift Temple */
      .gift-temple {
        height: 100vh;
        width: 100vw;
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
        z-index: 10;
        padding: clamp(1.5rem, 4vh, 3rem);
        padding-top: clamp(6rem, 14vh, 9rem);
      }

      .sacred-vessel {
        width: 100%;
        max-width: 1200px;
        height: 100%;
        max-height: 750px;
        background: linear-gradient(
          135deg,
          rgba(255, 255, 255, 0.12) 0%,
          rgba(255, 255, 255, 0.06) 50%,
          rgba(255, 255, 255, 0.08) 100%
        );
        backdrop-filter: blur(40px) saturate(140%);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 32px;
        position: relative;
        overflow: hidden;
        animation: vesselManifestation 1.5s ease-out;
        display: grid;
        grid-template-columns: 1fr 1fr;
        box-shadow: 0 32px 80px rgba(0, 0, 0, 0.4),
          inset 0 1px 0 rgba(255, 255, 255, 0.15),
          0 0 120px rgba(255, 255, 255, 0.08);
      }

      @keyframes vesselManifestation {
        0% {
          opacity: 0;
          transform: scale(0.9) translateY(40px);
          filter: blur(20px);
        }
        60% {
          opacity: 0.8;
          transform: scale(1.02) translateY(-5px);
          filter: blur(2px);
        }
        100% {
          opacity: 1;
          transform: scale(1) translateY(0);
          filter: blur(0);
        }
      }

      .sacred-vessel::before {
        content: "";
        position: absolute;
        inset: 2px;
        background: linear-gradient(
          135deg,
          rgba(255, 255, 255, 0.1) 0%,
          rgba(255, 255, 255, 0.02) 50%,
          rgba(255, 255, 255, 0.06) 100%
        );
        border-radius: 30px;
        pointer-events: none;
      }

      /* Gift Creation Sanctuary (Left Panel) */
      .creation-sanctuary {
        padding: clamp(2.5rem, 5vh, 4rem);
        display: flex;
        flex-direction: column;
        height: 100%;
        overflow-y: auto;
        scrollbar-width: none;
        -ms-overflow-style: none;
        position: relative;
        z-index: 2;
      }

      .creation-sanctuary::-webkit-scrollbar {
        display: none;
      }

      .sacred-header {
        text-align: center;
        margin-bottom: clamp(2rem, 4vh, 2.5rem);
        position: relative;
      }

      .sacred-header::before {
        content: "";
        position: absolute;
        top: -20px;
        left: 50%;
        transform: translateX(-50%);
        width: 60px;
        height: 2px;
        background: linear-gradient(
          90deg,
          transparent 0%,
          rgba(251, 191, 36, 0.6) 50%,
          transparent 100%
        );
      }

      .gift-invocation {
        font-size: clamp(1.8rem, 5vw, 2.4rem);
        font-weight: 200;
        margin-bottom: 1rem;
        background: linear-gradient(
          135deg,
          rgba(255, 255, 255, 0.95) 0%,
          rgba(251, 191, 36, 0.9) 30%,
          rgba(147, 51, 234, 0.8) 70%,
          rgba(255, 255, 255, 0.95) 100%
        );
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
        letter-spacing: 1px;
        line-height: 1.2;
        text-shadow: 0 0 30px rgba(251, 191, 36, 0.3);
        position: relative;
      }

      .sacred-intention {
        font-size: clamp(1rem, 2.5vw, 1.2rem);
        opacity: 0.85;
        line-height: 1.6;
        color: rgba(255, 255, 255, 0.8);
        font-weight: 300;
        font-style: italic;
        max-width: 400px;
        margin: 0 auto;
      }

      /* Sacred Form */
      .consciousness-form {
        flex: 1;
        display: flex;
        flex-direction: column;
        gap: clamp(1.2rem, 2.5vh, 1.8rem);
      }

      .essence-section {
        background: rgba(255, 255, 255, 0.04);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 20px;
        padding: clamp(1.5rem, 3vh, 2rem);
        position: relative;
        overflow: hidden;
        transition: all 0.4s ease;
      }

      .essence-section::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 1px;
        background: linear-gradient(
          90deg,
          transparent 0%,
          rgba(255, 255, 255, 0.3) 50%,
          transparent 100%
        );
      }

      .essence-section:hover {
        background: rgba(255, 255, 255, 0.06);
        border-color: rgba(255, 255, 255, 0.15);
        transform: translateY(-1px);
      }

      .essence-title {
        font-size: clamp(1rem, 2.5vw, 1.1rem);
        font-weight: 500;
        margin-bottom: 1.2rem;
        color: rgba(255, 255, 255, 0.9);
        display: flex;
        align-items: center;
        gap: 0.8rem;
        letter-spacing: 0.5px;
      }

      .essence-title::before {
        content: "‚ú®";
        font-size: 1em;
        opacity: 0.8;
        filter: drop-shadow(0 0 8px rgba(251, 191, 36, 0.4));
      }

      .soul-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 1rem;
      }

      .soul-field {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
      }

      .soul-field.full-essence {
        grid-column: 1 / -1;
      }

      .field-label {
        font-size: clamp(0.85rem, 2vw, 0.95rem);
        font-weight: 400;
        color: rgba(255, 255, 255, 0.75);
        letter-spacing: 0.3px;
        margin-bottom: 0.3rem;
      }

      .ethereal-input {
        padding: clamp(0.8rem, 2vh, 1rem);
        background: linear-gradient(
          135deg,
          rgba(255, 255, 255, 0.08) 0%,
          rgba(255, 255, 255, 0.04) 100%
        );
        border: 1px solid rgba(255, 255, 255, 0.15);
        border-radius: 16px;
        color: #fff;
        font-size: clamp(0.9rem, 2.2vw, 1rem);
        font-family: inherit;
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        -webkit-appearance: none;
        appearance: none;
        touch-action: manipulation;
        -webkit-tap-highlight-color: transparent;
        min-height: 48px;
        position: relative;
      }

      .ethereal-input::before {
        content: "";
        position: absolute;
        inset: -1px;
        background: linear-gradient(
          135deg,
          rgba(251, 191, 36, 0.3) 0%,
          rgba(147, 51, 234, 0.2) 100%
        );
        border-radius: 16px;
        opacity: 0;
        transition: opacity 0.4s ease;
        z-index: -1;
      }

      .ethereal-input:focus {
        outline: none;
        border-color: rgba(251, 191, 36, 0.5);
        background: linear-gradient(
          135deg,
          rgba(255, 255, 255, 0.12) 0%,
          rgba(255, 255, 255, 0.06) 100%
        );
        box-shadow: 0 0 20px rgba(251, 191, 36, 0.2),
          inset 0 1px 0 rgba(255, 255, 255, 0.1);
        transform: translateY(-1px);
      }

      .ethereal-input:focus::before {
        opacity: 1;
      }

      .ethereal-input::placeholder {
        color: rgba(255, 255, 255, 0.4);
        font-style: italic;
      }

      .soul-message {
        min-height: 100px;
        resize: none;
        line-height: 1.6;
      }

      .essence-counter {
        text-align: right;
        font-size: 0.8rem;
        opacity: 0.6;
        margin-top: 0.4rem;
        transition: color 0.3s ease;
      }

      /* Sacred Selection Chambers */
      .selection-chamber {
        margin: clamp(0.8rem, 1.5vh, 1rem) 0;
      }

      .chamber-title {
        font-size: clamp(0.95rem, 2.2vw, 1.05rem);
        font-weight: 500;
        margin-bottom: 1rem;
        color: rgba(255, 255, 255, 0.85);
        display: flex;
        align-items: center;
        gap: 0.6rem;
        letter-spacing: 0.4px;
      }

      .chamber-title::before {
        content: "üåü";
        font-size: 0.9em;
        opacity: 0.8;
      }

      .consciousness-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 1rem;
        margin-bottom: 1.5rem;
      }

      .consciousness-choice {
        background: linear-gradient(
          135deg,
          rgba(255, 255, 255, 0.06) 0%,
          rgba(255, 255, 255, 0.02) 100%
        );
        border: 1px solid rgba(255, 255, 255, 0.12);
        border-radius: 18px;
        padding: clamp(1rem, 2vh, 1.4rem);
        cursor: pointer;
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        text-align: center;
        position: relative;
        overflow: hidden;
        touch-action: manipulation;
        -webkit-tap-highlight-color: transparent;
      }

      .consciousness-choice::before {
        content: "";
        position: absolute;
        inset: 0;
        background: linear-gradient(
          135deg,
          rgba(251, 191, 36, 0.1) 0%,
          rgba(147, 51, 234, 0.08) 100%
        );
        opacity: 0;
        transition: opacity 0.4s ease;
      }

      .consciousness-choice:hover {
        background: linear-gradient(
          135deg,
          rgba(255, 255, 255, 0.1) 0%,
          rgba(255, 255, 255, 0.04) 100%
        );
        border-color: rgba(255, 255, 255, 0.25);
        transform: translateY(-2px) scale(1.02);
        box-shadow: 0 8px 32px rgba(255, 255, 255, 0.1);
      }

      .consciousness-choice:hover::before {
        opacity: 0.5;
      }

      .consciousness-choice.selected {
        background: linear-gradient(
          135deg,
          rgba(251, 191, 36, 0.15) 0%,
          rgba(147, 51, 234, 0.1) 100%
        );
        border-color: rgba(251, 191, 36, 0.4);
        box-shadow: 0 0 25px rgba(251, 191, 36, 0.2),
          inset 0 1px 0 rgba(255, 255, 255, 0.1);
        transform: translateY(-1px);
      }

      .consciousness-choice.selected::before {
        opacity: 1;
      }

      .consciousness-choice.premium {
        border-color: rgba(251, 191, 36, 0.25);
        background: linear-gradient(
          135deg,
          rgba(251, 191, 36, 0.08) 0%,
          rgba(255, 255, 255, 0.04) 100%
        );
        position: relative;
        padding-top: clamp(1.8rem, 3vh, 2.2rem);
      }

      .wisdom-badge {
        position: absolute;
        top: -8px;
        right: 12px;
        background: linear-gradient(135deg, #f59e0b, #d97706);
        color: white;
        padding: 0.4rem 0.8rem;
        border-radius: 12px;
        font-size: 0.7rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.8px;
        box-shadow: 0 4px 16px rgba(245, 158, 11, 0.4);
      }

      .choice-name {
        font-size: clamp(1rem, 2.5vw, 1.1rem);
        font-weight: 600;
        margin-bottom: 0.6rem;
        color: rgba(255, 255, 255, 0.95);
        letter-spacing: 0.3px;
      }

      .choice-essence {
        font-size: clamp(0.8rem, 2vw, 0.9rem);
        color: rgba(255, 255, 255, 0.7);
        line-height: 1.4;
      }

      /* Duration Selection */
      .duration-realm {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 0.8rem;
      }

      .duration-portal {
        background: linear-gradient(
          135deg,
          rgba(255, 255, 255, 0.06) 0%,
          rgba(255, 255, 255, 0.02) 100%
        );
        border: 1px solid rgba(255, 255, 255, 0.12);
        border-radius: 16px;
        padding: clamp(0.8rem, 1.8vh, 1.2rem);
        cursor: pointer;
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        text-align: center;
        touch-action: manipulation;
        -webkit-tap-highlight-color: transparent;
        position: relative;
        overflow: hidden;
      }

      .duration-portal::before {
        content: "";
        position: absolute;
        inset: 0;
        background: linear-gradient(
          135deg,
          rgba(16, 185, 129, 0.1) 0%,
          rgba(59, 130, 246, 0.08) 100%
        );
        opacity: 0;
        transition: opacity 0.4s ease;
      }

      .duration-portal:hover {
        background: linear-gradient(
          135deg,
          rgba(255, 255, 255, 0.1) 0%,
          rgba(255, 255, 255, 0.04) 100%
        );
        border-color: rgba(255, 255, 255, 0.2);
        transform: translateY(-1px);
      }

      .duration-portal:hover::before {
        opacity: 0.5;
      }

      .duration-portal.selected {
        background: linear-gradient(
          135deg,
          rgba(16, 185, 129, 0.15) 0%,
          rgba(59, 130, 246, 0.1) 100%
        );
        border-color: rgba(16, 185, 129, 0.4);
        box-shadow: 0 0 20px rgba(16, 185, 129, 0.2);
      }

      .duration-portal.selected::before {
        opacity: 1;
      }

      .duration-name {
        font-size: clamp(0.85rem, 2vw, 0.95rem);
        font-weight: 500;
        margin-bottom: 0.4rem;
        color: rgba(255, 255, 255, 0.9);
      }

      .duration-energy {
        font-size: clamp(1rem, 2.5vw, 1.2rem);
        font-weight: 700;
        color: #10b981;
        line-height: 1;
      }

      /* Sacred Exchange (Payment) */
      .sacred-exchange {
        margin-top: auto;
        padding-top: clamp(1.5rem, 3vh, 2rem);
        border-top: 1px solid rgba(255, 255, 255, 0.1);
      }

      .exchange-vessel {
        background: linear-gradient(
          135deg,
          rgba(255, 255, 255, 0.08) 0%,
          rgba(255, 255, 255, 0.04) 100%
        );
        border: 1px solid rgba(255, 255, 255, 0.15);
        border-radius: 18px;
        padding: 1.5rem;
        margin-bottom: 1.2rem;
        text-align: center;
        position: relative;
        overflow: hidden;
      }

      .exchange-vessel::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 2px;
        background: linear-gradient(
          90deg,
          transparent 0%,
          rgba(251, 191, 36, 0.6) 50%,
          transparent 100%
        );
      }

      .exchange-total {
        font-size: clamp(1.4rem, 3.5vw, 1.8rem);
        font-weight: 600;
        color: rgba(255, 255, 255, 0.95);
        margin-bottom: 0.3rem;
        background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
      }

      .exchange-details {
        font-size: clamp(0.9rem, 2vw, 1rem);
        color: rgba(255, 255, 255, 0.7);
      }

      #paypal-button-container {
        min-height: 50px;
        margin: 1rem 0;
        border-radius: 12px;
        overflow: hidden;
      }

      .manifestation-loading {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 1rem;
        padding: 1.2rem;
        background: linear-gradient(
          135deg,
          rgba(59, 130, 246, 0.12) 0%,
          rgba(59, 130, 246, 0.06) 100%
        );
        border: 1px solid rgba(59, 130, 246, 0.25);
        border-radius: 16px;
        color: #93c5fd;
        font-size: 0.9rem;
      }

      .cosmic-spinner {
        width: 18px;
        height: 18px;
        border: 2px solid rgba(147, 197, 253, 0.3);
        border-radius: 50%;
        border-top-color: #93c5fd;
        animation: cosmicSpin 1s linear infinite;
      }

      @keyframes cosmicSpin {
        to {
          transform: rotate(360deg);
        }
      }

      /* Vision Chamber (Right Panel) */
      .vision-chamber {
        background: linear-gradient(
          135deg,
          rgba(255, 255, 255, 0.08) 0%,
          rgba(255, 255, 255, 0.04) 100%
        );
        border-left: 1px solid rgba(255, 255, 255, 0.15);
        padding: clamp(2.5rem, 5vh, 4rem);
        display: flex;
        flex-direction: column;
        position: relative;
        overflow: hidden;
      }

      .vision-chamber::before {
        content: "";
        position: absolute;
        top: 15%;
        right: -15%;
        width: 250px;
        height: 250px;
        background: radial-gradient(
          circle,
          rgba(251, 191, 36, 0.12) 0%,
          rgba(147, 51, 234, 0.08) 40%,
          transparent 70%
        );
        border-radius: 50%;
        animation: visionPulse 12s ease-in-out infinite;
        filter: blur(30px);
      }

      @keyframes visionPulse {
        0%,
        100% {
          transform: scale(1) rotate(0deg);
          opacity: 0.6;
        }
        50% {
          transform: scale(1.3) rotate(180deg);
          opacity: 0.9;
        }
      }

      .vision-header {
        text-align: center;
        margin-bottom: clamp(2rem, 4vh, 2.5rem);
        position: relative;
        z-index: 2;
      }

      .vision-symbol {
        font-size: clamp(3rem, 7vw, 4rem);
        margin-bottom: 1.2rem;
        animation: giftAwakening 4s ease-in-out infinite;
        filter: drop-shadow(0 0 20px rgba(251, 191, 36, 0.4));
      }

      @keyframes giftAwakening {
        0%,
        100% {
          transform: scale(1) rotate(0deg);
        }
        25% {
          transform: scale(1.05) rotate(5deg);
        }
        75% {
          transform: scale(1.05) rotate(-5deg);
        }
      }

      .vision-title {
        font-size: clamp(1.4rem, 3.5vw, 1.8rem);
        font-weight: 500;
        margin-bottom: 0.8rem;
        color: rgba(255, 255, 255, 0.95);
        letter-spacing: 0.5px;
      }

      .vision-essence {
        font-size: clamp(0.95rem, 2.2vw, 1.1rem);
        color: rgba(255, 255, 255, 0.75);
        line-height: 1.6;
        font-style: italic;
      }

      .manifestation-preview {
        flex: 1;
        position: relative;
        z-index: 2;
      }

      .gift-revelations {
        display: flex;
        flex-direction: column;
        gap: clamp(1rem, 2vh, 1.2rem);
      }

      .revelation-item {
        display: flex;
        align-items: center;
        gap: 1.2rem;
        padding: clamp(1rem, 2vh, 1.3rem);
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 16px;
        transition: all 0.4s ease;
        position: relative;
        overflow: hidden;
      }

      .revelation-item::before {
        content: "";
        position: absolute;
        left: 0;
        top: 0;
        bottom: 0;
        width: 3px;
        background: linear-gradient(
          180deg,
          rgba(251, 191, 36, 0.8) 0%,
          rgba(147, 51, 234, 0.6) 100%
        );
        opacity: 0;
        transition: opacity 0.4s ease;
      }

      .revelation-item:hover {
        background: rgba(255, 255, 255, 0.08);
        border-color: rgba(255, 255, 255, 0.18);
        transform: translateX(4px);
      }

      .revelation-item:hover::before {
        opacity: 1;
      }

      .revelation-symbol {
        font-size: 1.8rem;
        min-width: 2.5rem;
        text-align: center;
        filter: drop-shadow(0 0 8px rgba(251, 191, 36, 0.3));
      }

      .revelation-text {
        font-size: clamp(0.9rem, 2.2vw, 1rem);
        color: rgba(255, 255, 255, 0.8);
        line-height: 1.5;
        flex: 1;
      }

      .revelation-premium {
        border-color: rgba(251, 191, 36, 0.25);
        background: linear-gradient(
          135deg,
          rgba(251, 191, 36, 0.08) 0%,
          rgba(255, 255, 255, 0.04) 100%
        );
        display: none;
      }

      .sacred-covenant {
        margin-top: auto;
        padding: clamp(1.2rem, 2.5vh, 1.8rem);
        background: linear-gradient(
          135deg,
          rgba(59, 130, 246, 0.1) 0%,
          rgba(147, 51, 234, 0.08) 100%
        );
        border: 1px solid rgba(59, 130, 246, 0.25);
        border-radius: 18px;
        position: relative;
        z-index: 2;
      }

      .covenant-title {
        font-size: clamp(1rem, 2.5vw, 1.1rem);
        font-weight: 600;
        margin-bottom: 0.8rem;
        color: rgba(255, 255, 255, 0.95);
        display: flex;
        align-items: center;
        gap: 0.6rem;
      }

      .covenant-wisdom {
        font-size: clamp(0.85rem, 2vw, 0.95rem);
        line-height: 1.6;
        color: rgba(255, 255, 255, 0.75);
      }

      /* Sacred States */
      .form-transcending {
        opacity: 0.6;
        pointer-events: none;
      }

      .manifestation-message {
        display: none;
        text-align: center;
        padding: 1.2rem;
        background: linear-gradient(
          135deg,
          rgba(59, 130, 246, 0.12) 0%,
          rgba(147, 51, 234, 0.08) 100%
        );
        border: 1px solid rgba(59, 130, 246, 0.25);
        border-radius: 16px;
        color: #93c5fd;
        margin-top: 1rem;
        font-size: 0.9rem;
      }

      /* Responsive Sacred Geometry */
      @media (max-width: 1024px) {
        .sacred-vessel {
          grid-template-columns: 1fr;
          grid-template-rows: 1fr auto;
          max-height: none;
          height: calc(100vh - 8rem);
        }

        .vision-chamber {
          border-left: none;
          border-top: 1px solid rgba(255, 255, 255, 0.15);
          max-height: 350px;
          overflow-y: auto;
        }

        .gift-revelations {
          flex-direction: row;
          flex-wrap: wrap;
          gap: 0.8rem;
        }

        .revelation-item {
          flex: 1;
          min-width: 220px;
          padding: 0.8rem;
        }

        .revelation-text {
          font-size: 0.85rem;
        }
      }

      @media (max-width: 768px) {
        .gift-temple {
          padding: 1.5rem;
          padding-top: 6rem;
        }

        .sacred-vessel {
          border-radius: 24px;
          height: calc(100vh - 7rem);
        }

        .creation-sanctuary,
        .vision-chamber {
          padding: 2rem;
        }

        .soul-grid {
          grid-template-columns: 1fr;
          gap: 0.8rem;
        }

        .consciousness-grid {
          grid-template-columns: 1fr;
        }

        .duration-realm {
          grid-template-columns: 1fr;
        }

        .return-portal {
          top: 1.5rem;
          left: 1.5rem;
          padding: 0.7rem 1.1rem;
          font-size: 0.85rem;
        }
      }

      @media (max-width: 480px) {
        .gift-temple {
          padding: 1rem;
          padding-top: 5rem;
        }

        .sacred-vessel {
          border-radius: 20px;
          grid-template-rows: 1fr 250px;
        }

        .creation-sanctuary {
          padding: 1.5rem;
        }

        .vision-chamber {
          padding: 1.5rem;
        }

        .vision-header {
          margin-bottom: 1.5rem;
        }

        .gift-revelations {
          gap: 0.6rem;
        }

        .revelation-item {
          padding: 0.7rem;
          min-width: 180px;
        }

        .return-portal {
          top: 1rem;
          left: 1rem;
          padding: 0.6rem 1rem;
          font-size: 0.8rem;
        }
      }

      /* Accessibility & Motion */
      @media (prefers-reduced-motion: reduce) {
        *,
        *::before,
        *::after {
          animation-duration: 0.01ms !important;
          animation-iteration-count: 1 !important;
          transition-duration: 0.01ms !important;
        }
      }

      /* iOS Safe Areas */
      @supports (padding: max(0px)) {
        .return-portal {
          top: max(1.5rem, env(safe-area-inset-top) + 1rem);
          left: max(1.5rem, env(safe-area-inset-left) + 1rem);
        }

        .gift-temple {
          padding-top: max(6rem, env(safe-area-inset-top) + 5rem);
          padding-left: max(1.5rem, env(safe-area-inset-left));
          padding-right: max(1.5rem, env(safe-area-inset-right));
        }
      }
    </style>
  </head>

  <body>
    <!-- Cosmic Consciousness Canvas -->
    <div class="cosmic-canvas">
      <div class="consciousness-layer"></div>
      <div class="consciousness-layer"></div>
      <div class="consciousness-layer"></div>
    </div>

    <!-- Sacred Particles -->
    <div class="sacred-particles">
      <div class="sacred-particle particle-consciousness"></div>
      <div class="sacred-particle particle-wisdom"></div>
      <div class="sacred-particle particle-love"></div>
      <div class="sacred-particle particle-consciousness"></div>
      <div class="sacred-particle particle-wisdom"></div>
      <div class="sacred-particle particle-love"></div>
    </div>

    <!-- Return Portal -->
    <a href="/" class="return-portal">
      <span>‚Üê</span>
      <span>Return to Portal</span>
    </a>

    <!-- Sacred Gift Temple -->
    <div class="gift-temple">
      <div class="sacred-vessel">
        <!-- Creation Sanctuary (Left Panel) -->
        <div class="creation-sanctuary">
          <div class="sacred-header">
            <h1 class="gift-invocation">Gift Sacred Consciousness</h1>
            <p class="sacred-intention">
              Share the eternal journey of self-discovery
            </p>
          </div>

          <form id="consciousnessForm" class="consciousness-form">
            <!-- Soul Connection -->
            <div class="essence-section">
              <h3 class="essence-title">Soul Connection</h3>
              <div class="soul-grid">
                <div class="soul-field">
                  <label class="field-label">Your Sacred Name</label>
                  <input
                    id="giverName"
                    type="text"
                    placeholder="Your name"
                    class="ethereal-input"
                    required
                  />
                </div>
                <div class="soul-field">
                  <label class="field-label">Your Light Address</label>
                  <input
                    id="giverEmail"
                    type="email"
                    placeholder="your@email.com"
                    class="ethereal-input"
                    required
                  />
                </div>
                <div class="soul-field">
                  <label class="field-label">Beloved Recipient</label>
                  <input
                    id="recipientName"
                    type="text"
                    placeholder="Who receives this gift?"
                    class="ethereal-input"
                    required
                  />
                </div>
                <div class="soul-field">
                  <label class="field-label">Their Light Address</label>
                  <input
                    id="recipientEmail"
                    type="email"
                    placeholder="their@email.com"
                    class="ethereal-input"
                    required
                  />
                </div>
                <div class="soul-field full-essence">
                  <label class="field-label">Sacred Message (Optional)</label>
                  <textarea
                    id="soulMessage"
                    class="ethereal-input soul-message"
                    placeholder="Why are you offering them this journey of self-discovery?"
                    maxlength="250"
                  ></textarea>
                  <div class="essence-counter">
                    <span id="messageCount">0</span>/250 characters
                  </div>
                </div>
              </div>
            </div>

            <!-- Consciousness Selection -->
            <div class="essence-section">
              <h3 class="essence-title">Choose Their Path</h3>

              <div class="selection-chamber">
                <h4 class="chamber-title">Consciousness Tier</h4>
                <div class="consciousness-grid">
                  <div class="consciousness-choice" data-tier="essential">
                    <div class="choice-name">Essential</div>
                    <div class="choice-essence">
                      5 sacred reflections monthly<br />Evolution insights<br />Growth
                      tracking
                    </div>
                  </div>
                  <div class="consciousness-choice premium" data-tier="premium">
                    <div class="wisdom-badge">Most Sacred</div>
                    <div class="choice-name">Premium</div>
                    <div class="choice-essence">
                      10 sacred reflections monthly<br />Enhanced AI
                      consciousness<br />Deeper wisdom
                    </div>
                  </div>
                </div>

                <h4 class="chamber-title">Sacred Duration</h4>
                <div class="duration-realm">
                  <div class="duration-portal" data-duration="1mo">
                    <div class="duration-name">One Moon</div>
                    <div class="duration-energy" id="price1mo">$4.99</div>
                  </div>
                  <div class="duration-portal" data-duration="3mo">
                    <div class="duration-name">Three Moons</div>
                    <div class="duration-energy" id="price3mo">$14.97</div>
                  </div>
                  <div class="duration-portal" data-duration="1yr">
                    <div class="duration-name">One Year</div>
                    <div class="duration-energy" id="price1yr">$49.99</div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Sacred Exchange -->
            <div class="sacred-exchange">
              <div class="exchange-vessel">
                <div class="exchange-total" id="giftTotal">$4.99</div>
                <div class="exchange-details" id="giftSummary">
                  Essential ‚Ä¢ One Moon
                </div>
              </div>

              <div class="manifestation-loading" id="paypalLoading">
                <div class="cosmic-spinner"></div>
                <span>Manifesting payment portal...</span>
              </div>

              <div id="paypal-button-container"></div>

              <div class="manifestation-message" id="processingMessage">
                ‚è≥ Weaving their sacred invitation across the cosmos...
              </div>
            </div>
          </form>
        </div>

        <!-- Vision Chamber (Right Panel) -->
        <div class="vision-chamber">
          <div class="vision-header">
            <div class="vision-symbol">üéÅ</div>
            <h3 class="vision-title">What They Shall Receive</h3>
            <p class="vision-essence">
              A complete consciousness evolution experience
            </p>
          </div>

          <div class="manifestation-preview">
            <div class="gift-revelations">
              <div class="revelation-item">
                <div class="revelation-symbol">üìß</div>
                <div class="revelation-text">Beautiful sacred invitation</div>
              </div>
              <div class="revelation-item">
                <div class="revelation-symbol">üö™</div>
                <div class="revelation-text">Instant portal access</div>
              </div>
              <div class="revelation-item">
                <div class="revelation-symbol">üìä</div>
                <div class="revelation-text">Personal evolution dashboard</div>
              </div>
              <div class="revelation-item">
                <div class="revelation-symbol">ü¶ã</div>
                <div class="revelation-text">Consciousness growth reports</div>
              </div>
              <div class="revelation-item revelation-premium">
                <div class="revelation-symbol">üß†</div>
                <div class="revelation-text">Enhanced AI consciousness</div>
              </div>
              <div class="revelation-item">
                <div class="revelation-symbol">üåô</div>
                <div class="revelation-text">
                  <span id="durationDisplay">One moon</span> of their chosen
                  reflections
                </div>
              </div>
            </div>
          </div>

          <div class="sacred-covenant">
            <div class="covenant-title">
              <span>üí°</span>
              <span>Sacred Understanding</span>
            </div>
            <div class="covenant-wisdom">
              This is a consciousness subscription - they receive ongoing access
              to their chosen reflection tier for the complete duration.
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      // Sacred Consciousness Gift Experience
      let paypalConfig = null;
      let paypalInitialized = false;
      let selectedTier = "essential";
      let selectedDuration = "1mo";
      let currentGiftAmount = "4.99";
      let giftPricing = {};

      // Initialize Sacred Experience
      window.addEventListener("load", initializeSacredGift);

      async function initializeSacredGift() {
        setupSacredListeners();
        await loadPayPalConfig();
        await loadGiftPricing();
        initializeSacredSelections();
        initializeMysticEffects();
      }

      function setupSacredListeners() {
        // Soul validation
        ["giverName", "giverEmail", "recipientName", "recipientEmail"].forEach(
          (id) => {
            document
              .getElementById(id)
              .addEventListener("input", validateSoulConnection);
          }
        );

        // Sacred message counter
        const soulMessage = document.getElementById("soulMessage");
        const messageCount = document.getElementById("messageCount");

        soulMessage.addEventListener("input", () => {
          const length = soulMessage.value.length;
          messageCount.textContent = length;

          const counter = document.querySelector(".essence-counter");
          if (length > 200) {
            counter.style.color = "#ef4444";
          } else if (length > 150) {
            counter.style.color = "#f59e0b";
          } else {
            counter.style.color = "rgba(255, 255, 255, 0.6)";
          }
        });

        // Sacred name formatting
        ["giverName", "recipientName"].forEach((id) => {
          document.getElementById(id).addEventListener("blur", function () {
            this.value = this.value.replace(/\b\w/g, (l) => l.toUpperCase());
          });
        });

        // Ethereal input effects
        document.querySelectorAll(".ethereal-input").forEach((input) => {
          input.addEventListener("focus", function () {
            createConsciousnessRipple(this);
          });
        });
      }

      async function loadGiftPricing() {
        try {
          const response = await fetch("/api/subscriptions?action=get-pricing");
          if (!response.ok) throw new Error(`HTTP ${response.status}`);

          const result = await response.json();
          if (!result.success)
            throw new Error(result.error || "Failed to load pricing");

          giftPricing = result.pricing.gifts;
          updateSacredPricing();
        } catch (error) {
          console.error("Sacred pricing error:", error);
          // Fallback pricing
          giftPricing = {
            essential: { "1mo": 4.99, "3mo": 14.97, "1yr": 49.99 },
            premium: { "1mo": 9.99, "3mo": 29.97, "1yr": 99.99 },
          };
          updateSacredPricing();
        }
      }

      function updateSacredPricing() {
        document.getElementById(
          "price1mo"
        ).textContent = `$${giftPricing[selectedTier]["1mo"]}`;
        document.getElementById(
          "price3mo"
        ).textContent = `$${giftPricing[selectedTier]["3mo"]}`;
        document.getElementById(
          "price1yr"
        ).textContent = `$${giftPricing[selectedTier]["1yr"]}`;

        currentGiftAmount =
          giftPricing[selectedTier][selectedDuration].toString();
        updateSacredExchange();
      }

      function initializeSacredSelections() {
        // Consciousness tier selection
        document.querySelectorAll(".consciousness-choice").forEach((choice) => {
          choice.addEventListener("click", function () {
            selectConsciousnessTier(this.dataset.tier);
          });
        });

        // Duration portal selection
        document.querySelectorAll(".duration-portal").forEach((portal) => {
          portal.addEventListener("click", function () {
            selectSacredDuration(this.dataset.duration);
          });
        });

        // Initialize with defaults
        selectConsciousnessTier("essential");
        selectSacredDuration("1mo");
      }

      function selectConsciousnessTier(tier) {
        selectedTier = tier;

        // Update consciousness choices
        document.querySelectorAll(".consciousness-choice").forEach((choice) => {
          choice.classList.remove("selected");
        });
        document
          .querySelector(`[data-tier="${tier}"]`)
          .classList.add("selected");

        // Reveal premium features
        const premiumRevelations = document.querySelectorAll(
          ".revelation-premium"
        );
        premiumRevelations.forEach((el) => {
          el.style.display = tier === "premium" ? "flex" : "none";
        });

        updateSacredPricing();
        createSelectionAura(document.querySelector(`[data-tier="${tier}"]`));

        if (paypalInitialized && paypalConfig) {
          reinitializePayPal();
        }
      }

      function selectSacredDuration(duration) {
        selectedDuration = duration;

        // Update duration portals
        document.querySelectorAll(".duration-portal").forEach((portal) => {
          portal.classList.remove("selected");
        });
        document
          .querySelector(`[data-duration="${duration}"]`)
          .classList.add("selected");

        // Update display
        const durationText =
          duration === "1mo"
            ? "one moon"
            : duration === "3mo"
            ? "three moons"
            : "one year";
        document.getElementById("durationDisplay").textContent =
          durationText.charAt(0).toUpperCase() + durationText.slice(1);

        currentGiftAmount = giftPricing[selectedTier][duration].toString();
        updateSacredExchange();
        createSelectionAura(
          document.querySelector(`[data-duration="${duration}"]`)
        );

        if (paypalInitialized && paypalConfig) {
          reinitializePayPal();
        }
      }

      function updateSacredExchange() {
        const tierName =
          selectedTier.charAt(0).toUpperCase() + selectedTier.slice(1);
        const durationText =
          selectedDuration === "1mo"
            ? "One Moon"
            : selectedDuration === "3mo"
            ? "Three Moons"
            : "One Year";

        document.getElementById(
          "giftSummary"
        ).textContent = `${tierName} ‚Ä¢ ${durationText}`;
        document.getElementById(
          "giftTotal"
        ).textContent = `$${currentGiftAmount}`;
      }

      async function loadPayPalConfig() {
        try {
          const response = await fetch("/api/payment?action=config");
          if (!response.ok) throw new Error(`HTTP ${response.status}`);

          const result = await response.json();
          if (!result.success)
            throw new Error(result.error || "PayPal configuration failed");

          paypalConfig = result.config;
          await loadPayPalSDK();
        } catch (error) {
          console.error("PayPal sacred error:", error);
          showSacredError(error.message);
        }
      }

      function loadPayPalSDK() {
        return new Promise((resolve, reject) => {
          if (window.paypal && window.paypal.Buttons) {
            hideManifestationLoading();
            initializePayPal();
            resolve();
            return;
          }

          const script = document.createElement("script");
          script.src = `https://www.paypal.com/sdk/js?client-id=${paypalConfig.clientId}&currency=${paypalConfig.currency}&intent=capture`;

          const timeout = setTimeout(() => {
            reject(new Error("PayPal manifestation timeout"));
          }, 15000);

          script.onload = () => {
            clearTimeout(timeout);
            setTimeout(() => {
              if (window.paypal && window.paypal.Buttons) {
                hideManifestationLoading();
                initializePayPal();
                resolve();
              } else {
                reject(
                  new Error("PayPal loaded but consciousness not available")
                );
              }
            }, 100);
          };

          script.onerror = () => {
            clearTimeout(timeout);
            reject(new Error("Failed to manifest PayPal portal"));
          };

          document.head.appendChild(script);
        });
      }

      function hideManifestationLoading() {
        document.getElementById("paypalLoading").style.display = "none";
      }

      function showSacredError(message) {
        document.getElementById("paypalLoading").style.display = "none";
        alert(`Sacred manifestation error: ${message}`);
      }

      function validateSoulConnection() {
        const giverName = document.getElementById("giverName").value.trim();
        const giverEmail = document.getElementById("giverEmail").value.trim();
        const recipientName = document
          .getElementById("recipientName")
          .value.trim();
        const recipientEmail = document
          .getElementById("recipientEmail")
          .value.trim();

        const allConnected =
          giverName &&
          giverEmail.includes("@") &&
          recipientName &&
          recipientEmail.includes("@");

        const paypalContainer = document.getElementById(
          "paypal-button-container"
        );
        if (paypalContainer) {
          paypalContainer.style.opacity = allConnected ? "1" : "0.5";
          paypalContainer.style.pointerEvents = allConnected ? "auto" : "none";
        }
      }

      function reinitializePayPal() {
        const container = document.getElementById("paypal-button-container");
        container.innerHTML = "";
        paypalInitialized = false;
        initializePayPal();
      }

      function initializePayPal() {
        if (!window.paypal || !window.paypal.Buttons) {
          showSacredError("PayPal consciousness not manifested");
          return;
        }

        if (!paypalConfig) {
          showSacredError("PayPal sacred configuration missing");
          return;
        }

        if (paypalInitialized) return;

        try {
          window.paypal
            .Buttons({
              style: {
                color: "gold",
                shape: "rect",
                label: "pay",
                height: 50,
                tagline: false,
              },

              onClick: function (data, actions) {
                const souls = [
                  "giverName",
                  "giverEmail",
                  "recipientName",
                  "recipientEmail",
                ];
                for (const soul of souls) {
                  const value = document.getElementById(soul).value.trim();
                  if (
                    !value ||
                    (soul.includes("Email") && !value.includes("@"))
                  ) {
                    alert(
                      `Please enter a valid ${soul
                        .replace(/([A-Z])/g, " $1")
                        .toLowerCase()}.`
                    );
                    return actions.reject();
                  }
                }
                return actions.resolve();
              },

              createOrder: function (data, actions) {
                const giverName = document
                  .getElementById("giverName")
                  .value.trim();
                const giverEmail = document
                  .getElementById("giverEmail")
                  .value.trim();
                const tierName =
                  selectedTier.charAt(0).toUpperCase() + selectedTier.slice(1);
                const durationText =
                  selectedDuration === "1mo"
                    ? "1 Month"
                    : selectedDuration === "3mo"
                    ? "3 Months"
                    : "1 Year";

                const orderData = {
                  purchase_units: [
                    {
                      amount: {
                        value: currentGiftAmount,
                        currency_code: paypalConfig.currency,
                      },
                      description: `Mirror of Truth - ${tierName} Sacred Gift (${durationText})`,
                    },
                  ],
                };

                if (giverEmail && giverEmail.includes("@")) {
                  orderData.payer = {
                    email_address: giverEmail,
                    name: {
                      given_name: giverName.split(" ")[0] || giverName,
                      surname: giverName.split(" ").slice(1).join(" ") || "",
                    },
                  };
                }

                return actions.order.create(orderData);
              },

              onApprove: function (data, actions) {
                return actions.order.capture().then(function (details) {
                  handleSacredManifestation(details);
                });
              },

              onError: function (err) {
                console.error("PayPal sacred error:", err);
                alert("Sacred exchange error. Please try again.");
                resetSacredState();
              },

              onCancel: function (data) {
                resetSacredState();
              },
            })
            .render("#paypal-button-container")
            .then(() => {
              paypalInitialized = true;
              validateSoulConnection();
            })
            .catch((error) => {
              console.error("PayPal manifestation error:", error);
              showSacredError("Failed to manifest payment portal");
            });
        } catch (error) {
          console.error("PayPal initialization error:", error);
          showSacredError("Failed to initialize sacred exchange");
        }
      }

      async function handleSacredManifestation(paymentDetails) {
        document
          .getElementById("consciousnessForm")
          .classList.add("form-transcending");
        document.getElementById("processingMessage").style.display = "block";

        try {
          const giftData = {
            giverName: document.getElementById("giverName").value.trim(),
            giverEmail: document.getElementById("giverEmail").value.trim(),
            recipientName: document
              .getElementById("recipientName")
              .value.trim(),
            recipientEmail: document
              .getElementById("recipientEmail")
              .value.trim(),
            personalMessage: document
              .getElementById("soulMessage")
              .value.trim(),
            subscriptionTier: selectedTier,
            subscriptionDuration: selectedDuration,
            amount: parseFloat(currentGiftAmount),
            paymentMethod: "paypal",
            paymentId: paymentDetails.id,
          };

          const response = await fetch("/api/subscriptions", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
              action: "gift-subscription",
              ...giftData,
            }),
          });

          const result = await response.json();

          if (!result.success) {
            throw new Error(result.error || "Failed to manifest sacred gift");
          }

          const tierName =
            selectedTier.charAt(0).toUpperCase() + selectedTier.slice(1);
          const durationText =
            selectedDuration === "1mo"
              ? "one moon"
              : selectedDuration === "3mo"
              ? "three moons"
              : "one year";

          setTimeout(() => {
            alert(
              `üéÅ Sacred gift manifested! ${giftData.recipientName} will receive ${durationText} of ${tierName} consciousness access.`
            );
            window.location.href = "/";
          }, 2000);
        } catch (error) {
          console.error("Sacred manifestation error:", error);
          alert(
            "Gift manifested but invitation weaving encountered cosmic interference. Contact our mystics."
          );
          setTimeout(() => {
            window.location.href = "/";
          }, 3000);
        }
      }

      function resetSacredState() {
        document
          .getElementById("consciousnessForm")
          .classList.remove("form-transcending");
        document.getElementById("processingMessage").style.display = "none";
      }

      // Sacred Mystic Effects
      function initializeMysticEffects() {
        // Cosmic consciousness mouse interaction
        document.addEventListener("mousemove", (e) => {
          const particles = document.querySelectorAll(".sacred-particle");
          const mouseX = e.clientX / window.innerWidth;
          const mouseY = e.clientY / window.innerHeight;

          particles.forEach((particle, i) => {
            const influence = (i + 1) * 1.2;
            const moveX = (mouseX - 0.5) * influence;
            const moveY = (mouseY - 0.5) * influence;
            particle.style.transform += ` translate(${moveX}px, ${moveY}px)`;
          });
        });

        // Sacred parallax
        window.addEventListener("scroll", () => {
          const scrolled = window.pageYOffset;
          const layers = document.querySelectorAll(".consciousness-layer");
          layers.forEach((layer, i) => {
            const speed = (i + 1) * 0.1;
            layer.style.transform += ` translateY(${scrolled * speed}px)`;
          });
        });
      }

      function createConsciousnessRipple(element) {
        const rect = element.getBoundingClientRect();
        for (let i = 0; i < 4; i++) {
          setTimeout(() => {
            const ripple = document.createElement("div");
            const offsetX = (Math.random() - 0.5) * 100;
            const offsetY = (Math.random() - 0.5) * 100;

            ripple.style.cssText = `
              position: fixed;
              left: ${rect.left + rect.width / 2 + offsetX}px;
              top: ${rect.top + rect.height / 2 + offsetY}px;
              width: 4px;
              height: 4px;
              background: radial-gradient(circle, rgba(251, 191, 36, 0.9) 0%, rgba(147, 51, 234, 0.3) 60%, transparent 80%);
              border-radius: 50%;
              pointer-events: none;
              z-index: 1000;
              animation: consciousnessRipple 2.5s ease-out forwards;
            `;

            document.body.appendChild(ripple);
            setTimeout(() => ripple.remove(), 2500);
          }, i * 100);
        }
      }

      function createSelectionAura(element) {
        const rect = element.getBoundingClientRect();
        for (let i = 0; i < 6; i++) {
          setTimeout(() => {
            const aura = document.createElement("div");
            const offsetX = (Math.random() - 0.5) * 120;
            const offsetY = (Math.random() - 0.5) * 120;

            aura.style.cssText = `
              position: fixed;
              left: ${rect.left + rect.width / 2 + offsetX}px;
              top: ${rect.top + rect.height / 2 + offsetY}px;
              width: 6px;
              height: 6px;
              background: radial-gradient(circle, rgba(16, 185, 129, 1) 0%, rgba(251, 191, 36, 0.8) 40%, rgba(147, 51, 234, 0.4) 70%, transparent 90%);
              border-radius: 50%;
              pointer-events: none;
              z-index: 1000;
              animation: selectionAura 3s ease-out forwards;
              box-shadow: 0 0 12px rgba(16, 185, 129, 0.6);
            `;

            document.body.appendChild(aura);
            setTimeout(() => aura.remove(), 3000);
          }, i * 80);
        }
      }

      // Add sacred animations
      const sacredStyle = document.createElement("style");
      sacredStyle.textContent = `
        @keyframes consciousnessRipple {
          0% { opacity: 0; transform: scale(0) rotate(0deg); }
          50% { opacity: 1; transform: scale(1.5) rotate(180deg); }
          100% { opacity: 0; transform: scale(0) rotate(360deg); }
        }

        @keyframes selectionAura {
          0% { opacity: 0; transform: scale(0) rotate(0deg); }
          30% { opacity: 1; transform: scale(1) rotate(108deg); }
          60% { opacity: 0.8; transform: scale(1.8) rotate(216deg); }
          100% { opacity: 0; transform: scale(0) rotate(360deg); }
        }
      `;
      document.head.appendChild(sacredStyle);

      // Sacred debug (development)
      if (window.location.hostname === "localhost") {
        console.log("üéÅ Sacred consciousness gift experience initialized");
        window.sacredDebug = {
          selectedTier: () => selectedTier,
          selectedDuration: () => selectedDuration,
          currentAmount: () => currentGiftAmount,
          pricing: () => giftPricing,
        };
      }
    </script>
  </body>
</html>
