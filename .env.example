# =======================
# MIRROR OF TRUTH - Environment Variables Template
# =======================
# Copy this file to .env.local for development: cp .env.example .env.local
# Never commit .env.local to git (it's in .gitignore)

# =======================
# SUPABASE (Required)
# =======================
# For local development, run: supabase start
# Then copy the values from the output

# Local: http://localhost:54321
# Production: Your Supabase project URL
SUPABASE_URL=http://localhost:54321

# Get this from: supabase status (API URL + anon key)
SUPABASE_ANON_KEY=your-supabase-anon-key-here

# Get this from: supabase status (service_role key)
# IMPORTANT: Keep this secret! Never expose in frontend code
SUPABASE_SERVICE_ROLE_KEY=your-supabase-service-role-key-here

# =======================
# AUTHENTICATION (Required)
# =======================
# Generate a strong random string for JWT signing
# Example: openssl rand -base64 32
JWT_SECRET=your-very-long-random-jwt-secret-minimum-32-characters

# =======================
# AI - ANTHROPIC CLAUDE (Required)
# =======================
# Get your API key from: https://console.anthropic.com
# Required for generating reflections and evolution reports
ANTHROPIC_API_KEY=sk-ant-api03-your-anthropic-key-here

# =======================
# EMAIL - GMAIL (Required for production)
# =======================
# Your Gmail address
GMAIL_USER=your-email@gmail.com

# Gmail App Password (NOT your regular password)
# Setup: Google Account → Security → 2-Step Verification → App passwords
# Generate a 16-character app password
GMAIL_APP_PASSWORD=your-16-char-app-password

# =======================
# REDIS - UPSTASH (Required for receipts)
# =======================
# For local testing, you can use a local Redis or Upstash free tier
# Sign up at: https://upstash.com

UPSTASH_REDIS_REST_URL=https://your-redis-url.upstash.io
UPSTASH_REDIS_REST_TOKEN=your-redis-token-here

# =======================
# PAYMENTS - PAYPAL (Required for subscriptions)
# =======================
# Get credentials from: https://developer.paypal.com/dashboard/applications
# For production, use live credentials

# PayPal API credentials
PAYPAL_CLIENT_ID=your-paypal-client-id
PAYPAL_CLIENT_SECRET=your-paypal-client-secret

# Environment: 'sandbox' for testing, 'live' for production
PAYPAL_ENVIRONMENT=sandbox

# PayPal Subscription Plan IDs (Sandbox - created 2025-11-30)
# Pro: $15/mo, $150/yr - 5 dreams, 30 reflections/month (max 1/day)
PAYPAL_PRO_MONTHLY_PLAN_ID=P-1J978568T3651942HNEV3UBY
PAYPAL_PRO_YEARLY_PLAN_ID=P-75F57632AL403313DNEV3UCA
# Unlimited: $29/mo, $290/yr - unlimited dreams, 60 reflections/month (max 2/day)
PAYPAL_UNLIMITED_MONTHLY_PLAN_ID=P-5U305295XW0926335NEV3UCA
PAYPAL_UNLIMITED_YEARLY_PLAN_ID=P-0LP821695B8135248NEV3UCI

# PayPal Webhook ID (for handling subscription events)
# Create at: PayPal Developer Dashboard → Webhooks
PAYPAL_WEBHOOK_ID=your-webhook-id

# =======================
# BUSINESS INFORMATION (Required for receipts)
# =======================
BUSINESS_NUMBER=your-business-number
BUSINESS_NAME=Your Business Name
BIT_PHONE=+1234567890

# =======================
# APPLICATION SETTINGS
# =======================
NODE_ENV=development
PORT=3000

# =======================
# LOGGING (Optional)
# =======================
# Log level: 'fatal' | 'error' | 'warn' | 'info' | 'debug' | 'trace'
# Default: 'info' in production, 'debug' in development
# LOG_LEVEL=info

# Your domain (for production)
DOMAIN=http://localhost:3000

# =======================
# SECURITY (Optional)
# =======================
# Admin key for manual operations
ADMIN_KEY=generate-a-random-admin-key-here

# =======================
# RATE LIMITING (Uses existing Redis)
# =======================
# Rate limiting uses the same Upstash Redis instance configured above.
# The following are optional overrides for rate limit values:

# Auth endpoint rate limit (per minute per IP, default: 5)
# Protects against brute-force attacks on signin/signup
# RATE_LIMIT_AUTH=5

# AI endpoint rate limit (per minute per user, default: 10)
# Protects against cost attacks on reflection generation
# RATE_LIMIT_AI=10

# Write endpoint rate limit (per minute per user, default: 30)
# Protects against spam on dream creation/updates
# RATE_LIMIT_WRITE=30

# Global rate limit (per minute per IP, default: 100)
# Basic DDoS protection for all endpoints
# RATE_LIMIT_GLOBAL=100

# Enable/disable rate limiting (default: true if Redis configured)
# Set to 'false' to disable rate limiting entirely
# RATE_LIMIT_ENABLED=true

# =======================
# ANALYTICS (Optional)
# =======================
# Google Analytics ID
GA_ID=G-XXXXXXXXXX

# PostHog API key for product analytics
POSTHOG_KEY=phc_xxxxxxxxxx

# =======================
# FEATURE FLAGS (Optional)
# =======================
ENABLE_COST_TRACKING=true
ENABLE_DETAILED_LOGGING=true
ENABLE_EMAIL_NOTIFICATIONS=true

# =======================
# SETUP INSTRUCTIONS
# =======================
#
# 1. LOCAL DEVELOPMENT SETUP
#    - Install Supabase CLI: npm install -g supabase
#    - Initialize: supabase init
#    - Start local instance: supabase start
#    - Copy .env.example to .env.local
#    - Fill in the Supabase keys from: supabase status
#    - Generate JWT_SECRET: openssl rand -base64 32
#    - Add your Anthropic API key
#
# 2. GMAIL SETUP (for email features)
#    - Enable 2-factor authentication on Gmail
#    - Generate app password: Google Account → Security → App passwords
#    - Use the 16-character password (not your regular Gmail password)
#
# 3. ANTHROPIC SETUP
#    - Sign up at: https://console.anthropic.com
#    - Add billing information
#    - Create API key
#    - Start with Claude Sonnet 4
#
# 4. PAYPAL SETUP (for subscriptions)
#    - Sign up at: https://developer.paypal.com
#    - Create app to get Client ID and Secret
#    - Create subscription products and plans
#    - Set up webhook endpoint for subscription events
#
# 5. REDIS SETUP (for receipts/sessions)
#    - Sign up at: https://upstash.com (free tier available)
#    - Create Redis database
#    - Copy REST URL and token
#
# 6. VERCEL DEPLOYMENT (production)
#    - Push code to GitHub
#    - Import project in Vercel
#    - Add all environment variables in Vercel dashboard
#    - Deploy!

# =======================
# TESTING
# =======================
# For testing with real APIs, create .env.test
# Use test API keys and a separate test database
